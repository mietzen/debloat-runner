name: Test max free space
on:
  push:
    branches: [ master ]
  pull_request:
    branches:
      - master

jobs:
  build-image:
    runs-on: ubuntu-latest
    name: "Free Space"
    steps:
    - name: Checkout config
      uses: actions/checkout@v2

    - name: Host info
      run: |
        echo "Disk space:"
        df -h /
        sudo du -ha -d 2 /opt

    - name: Free disk space
      run: |
        chmod +x ./free-space.sh
        ./free-space.sh

    - name: Host info
      run: |
        echo "Disk space:"
        df -h /
        sudo du -ha -d 1 --exclude=/{proc,sys,dev} /

